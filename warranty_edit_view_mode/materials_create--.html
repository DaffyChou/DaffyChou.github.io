<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>物料管理 - 新增物料</title>

  <!-- Bootstrap 5 (same stack as provided pages) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

  <!-- Project styles -->
  <link rel="stylesheet" href="./styles.css">
  <link rel="stylesheet" href="./materials_tree.css">
  <link rel="stylesheet" href="./materials_create.css">

</head>

<body data-page="materials-create">
  <div class="page">
    <div class="shell">
      <main class="content">
        <!-- Header (match materials_tree.html style) -->
        <div class="content__header">
          <div class="content__title">物料管理</div>
          <div class="content__actions d-flex gap-2">
            <a class="btn btn-outline-secondary btn-sm" href="./materials_tree.html">
              <i class="bi bi-list-ul me-1"></i>返回列表
            </a>
            <a class="btn btn-outline-secondary btn-sm" href="./list.html">維修保養管理</a>
          </div>
        </div>

        <div class="panel">
          <div class="panel__head">
            <div class="panel__hint">
              以「物料主檔」為核心建立資料；系統/裝備採樹狀選取，降低重複與分類錯誤。
            </div>
            <div class="panel__headActions">
              <button class="btn btn-outline-secondary btn-sm" type="button" id="btnDraft">
                <i class="bi bi-save2 me-1"></i>儲存草稿
              </button>
              <button class="btn btn-primary btn-sm" type="button" id="btnCreate">
                <i class="bi bi-check2-circle me-1"></i>建立物料
              </button>
            </div>
          </div>

          <div class="materialsLayout">
            <!-- Left: tree (reuse same visual language) -->
            <aside class="materialsAside">
              <div class="materialsAside__head">
                <div class="materialsAside__title">構型（選擇歸屬）</div>
                <div class="materialsAside__sub">點選節點右側「選取」帶入主檔</div>
              </div>
              <div class="materialsTree" id="materialsTree" aria-label="構型樹"></div>
            </aside>

            <!-- Right: create form -->
            <section class="materialsMain materialsMain--create">
              <div class="stepper" aria-label="新增步驟">
                <div class="step is-active"><span class="step__num">1</span>基本資料</div>
                <div class="step"><span class="step__num">2</span>系統/裝備</div>
                <div class="step"><span class="step__num">3</span>庫存管理</div>
                <div class="step"><span class="step__num">4</span>附件/備註</div>
              </div>

              <!-- Card A -->
              <div class="formCard">
                <div class="formCard__head">
                  <div>
                    <div class="formCard__title">Step 1｜物料基本資料</div>
                    <div class="formCard__sub">對應列表欄位：料號 / 中文名稱 / 英文名稱 / 規格 / 製造商 / 供應商 / 單價</div>
                  </div>
                  <div class="hintInline">
                    <i class="bi bi-info-circle"></i>
                    <div>必填欄位以<span class="req">*</span>標示；料號會即時檢查是否重複。</div>
                  </div>
                </div>

                <div class="formCard__body">
                  <div class="formGrid formGrid--table formGrid--auto2">
                    <div class="field">
                      <div class="field__label">料號（PN）<span class="req">*</span></div>
                      <div class="field__control">
                        <div class="pnCheck">
                          <input class="input" id="pn" type="text" placeholder="例如：BULB-24V-15W-01" />
                          <span class="pnCheck__state" id="pnState">
                            <span class="warnBadge"><i class="bi bi-search"></i>尚未檢查</span>
                          </span>
                        </div>
                        <div class="mt8 muted">建議：統一命名規則，以利跨系統比對與採購。</div>
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">單價</div>
                      <div class="field__control">
                        <input class="input" id="unitPrice" type="number" min="0" step="1" placeholder="例如：3600" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">中文名稱<span class="req">*</span></div>
                      <div class="field__control">
                        <input class="input" id="nameZh" type="text" placeholder="例如：小型螺口燈泡" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">英文名稱</div>
                      <div class="field__control">
                        <input class="input" id="nameEn" type="text" placeholder="例如：Small Screw Bulb" />
                      </div>
                    </div>

                    <div class="field field--full">
                      <div class="field__label">規格</div>
                      <div class="field__control">
                        <input class="input" id="spec" type="text" placeholder="例如：24V / 15W、Ø920mm / 3pcs set" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">製造商</div>
                      <div class="field__control">
                        <select class="input" id="maker">
                          <option value="">— 請選擇 —</option>
                          <option>SAMYUNG</option>
                          <option>MAN B&W</option>
                          <option>Wärtsilä</option>
                          <option>MITSUBISHI</option>
                          <option>RENK</option>
                          <option>Marine Power Inc.</option>
                          <option>AuxiEngine Co.</option>
                        </select>
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">供應商</div>
                      <div class="field__control">
                        <select class="input" id="vendor">
                          <option value="">— 請選擇 —</option>
                          <option>A廠商</option>
                          <option>B廠商</option>
                          <option>C廠商</option>
                          <option>D廠商</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Card B -->
              <div class="formCard">
                <div class="formCard__head">
                  <div>
                    <div class="formCard__title">Step 2｜系統 / 裝備關聯</div>
                    <div class="formCard__sub">對應列表欄位：位置 / 適用裝備名稱 / 適用裝備英文名稱（並與左側構型樹對齊）</div>
                  </div>
                  <div class="hintInline">
                    <i class="bi bi-diagram-3"></i>
                    <div>建議先在左側選取構型節點，再填寫位置與適用裝備資訊。</div>
                  </div>
                </div>

                <div class="formCard__body">
                  <div class="formGrid formGrid--table formGrid--auto2">
                    <div class="field field--full">
                      <div class="field__label">構型路徑（由左側選取）<span class="req">*</span></div>
                      <div class="field__control">
                        <div class="selectedPath">
                          <div class="selectedPath__val" id="pathText">尚未選取</div>
                          <div class="selectedPath__meta">系統將以此路徑作為左側樹狀歸屬與後續查詢索引。</div>
                        </div>
                        <input type="hidden" id="path" value="">
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">位置</div>
                      <div class="field__control">
                        <select class="input" id="location">
                          <option value="">— 請選擇 —</option>
                          <option>羅經艙</option>
                          <option>艦橋</option>
                          <option>機艙</option>
                          <option>機艙／主機</option>
                        </select>
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">適用裝備名稱</div>
                      <div class="field__control">
                        <input class="input" id="equipZh" type="text" placeholder="例如：磁羅經系統 / 推進系統" />
                      </div>
                    </div>

                    <div class="field field--full">
                      <div class="field__label">適用裝備英文名稱</div>
                      <div class="field__control">
                        <input class="input" id="equipEn" type="text" placeholder="例如：Magnetic Compass System / Propulsion System" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Card C -->
              <div class="formCard">
                <div class="formCard__head">
                  <div>
                    <div class="formCard__title">Step 3｜庫存與管理</div>
                    <div class="formCard__sub">對應列表欄位：庫存數量；並保留後續「庫存異動流程」擴充空間</div>
                  </div>
                  <div class="hintInline">
                    <i class="bi bi-box-seam"></i>
                    <div>新增時僅設定初始值；後續異動建議走專屬流程以保留稽核軌跡。</div>
                  </div>
                </div>

                <div class="formCard__body">
                  <div class="formGrid formGrid--table formGrid--auto2">
                    <div class="field">
                      <div class="field__label">初始庫存</div>
                      <div class="field__control">
                        <input class="input" id="stockQty" type="number" min="0" step="1" placeholder="例如：2687" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">庫存上限</div>
                      <div class="field__control">
                        <input class="input" id="stockMax" type="number" min="0" step="1" placeholder="例如：50000" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">安全庫存</div>
                      <div class="field__control">
                        <input class="input" id="safetyStock" type="number" min="0" step="1" placeholder="例如：5000" />
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">管理單位</div>
                      <div class="field__control">
                        <select class="input" id="mgmtUnit">
                          <option value="">— 請選擇 —</option>
                          <option>A單位</option>
                          <option>B單位</option>
                          <option>C單位</option>
                        </select>
                      </div>
                    </div>

                    <div class="field field--full">
                      <div class="field__label">管制設定</div>
                      <div class="field__control">
                        <div class="checks checks--inline">
                          <label class="check"><input id="isControlled" type="checkbox" /> 高價值 / 關鍵零件（建議啟用後續簽核）</label>
                        </div>
                        <div class="mt8 muted">提示：若啟用管制，後續請購/領用可納入簽核與稽核。</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Card D -->
              <div class="formCard">
                <div class="formCard__head">
                  <div>
                    <div class="formCard__title">Step 4｜附件 / 備註</div>
                    <div class="formCard__sub">支援替代料號、規格書/圖紙/證書等文件上傳</div>
                  </div>
                </div>

                <div class="formCard__body">
                  <div class="formGrid formGrid--table">
                    <div class="field">
                      <div class="field__label">替代料號</div>
                      <div class="field__control">
                        <input class="input" id="altPns" type="text" placeholder="以逗號分隔，例如：BULB-24V-15W-02, BULB-24V-15W-03" />
                        <div class="mt8 muted">進階版本可改為多選關聯既有物料。</div>
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">附件上傳</div>
                      <div class="field__control">
                        <div class="attachBox">
                          <div class="attachHead">
                            <div class="muted">附件檔案（可新增多筆；每筆可填說明）</div>
                            <button class="btn btn-outline-secondary" type="button" id="addAttach">
                              <i class="bi bi-paperclip me-1"></i>新增附件
                            </button>
                          </div>
                          <div class="attachList" id="attachList"></div>
                        </div>
                      </div>
                    </div>

                    <div class="field">
                      <div class="field__label">備註</div>
                      <div class="field__control">
                        <textarea class="textarea" id="note" rows="3" placeholder="補充說明（例如：替代料條件、保存方式、採購注意事項）"></textarea>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="stickyActions">
                  <a class="btn btn-outline-secondary" href="./materials_tree.html">
                    取消
                  </a>
                  <button class="btn btn-outline-secondary" type="button" id="btnDraft2">
                    儲存草稿
                  </button>
                  <button class="btn btn-primary" type="button" id="btnCreate2">
                    建立物料
                  </button>
                </div>
              </div>

            </section>
          </div>

        </div>
      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script></script>

</body>
</html>
